<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>清单Plus</title>
<meta name="theme-color" content="#121421" />
<style>
:root {
  --bg:#121421; --panel:#1c2033; --muted:#2a304a;
  --text:#f0f2ff; --sub:#99a0c2;
  --brand:#5a82ff; --accent:#22cda7; --danger:#ff5d5d;
  --line:rgba(255,255,255,.08);
}
[data-theme="light"] {
  --bg:#f7f8ff; --panel:#ffffff; --muted:#eef0f8;
  --text:#1c2033; --sub:#5c6178;
  --brand:#345dff; --accent:#17b892; --danger:#d43a3a;
  --line:rgba(0,0,0,.08);
}
*{box-sizing:border-box;font-family:-apple-system,Segoe UI,Roboto,"PingFang SC","Microsoft YaHei",sans-serif}
body{margin:0;background:var(--bg);color:var(--text);min-height:100dvh;display:flex;flex-direction:column}

header{display:flex;align-items:center;padding:14px;background:var(--panel);gap:10px}
.logo{width:28px;height:28px;border-radius:8px;background:var(--brand)}
.title{font-weight:700;font-size:18px}
.space{flex:1}
.iconbtn{width:36px;height:36px;display:grid;place-items:center;border:0;border-radius:10px;background:var(--muted);color:var(--text);cursor:pointer}

main{flex:1;display:flex;overflow:hidden}
.sidebar{width:120px;background:var(--panel);padding:10px;display:flex;flex-direction:column;gap:8px}
.sidebar h4{margin:10px 0 4px;font-size:12px;color:var(--sub)}
.navbtn{padding:8px;border-radius:8px;background:transparent;text-align:left;cursor:pointer;font-size:14px;color:var(--text)}
.navbtn.on{background:var(--muted);font-weight:700}
.counter{float:right;color:var(--sub)}

.content{flex:1;padding:12px;display:flex;flex-direction:column}
.taskbar{display:flex;gap:8px;margin-bottom:10px}
.taskbar input{flex:1;padding:10px;border-radius:10px;border:1px solid var(--line);background:var(--muted);color:var(--text)}
.taskbar button{padding:0 14px;border:0;border-radius:10px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}

.filters{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.filter{padding:6px 12px;border-radius:999px;background:var(--muted);cursor:pointer;font-size:13px}
.filter.on{background:var(--brand);color:#fff}

.tasks{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:8px}
.task{background:var(--panel);padding:10px;border-radius:10px;display:flex;justify-content:space-between;align-items:center}
.task.done .title{text-decoration:line-through;opacity:.6}
.title{font-weight:600}
.actions{display:flex;gap:6px}
.btn-mini{padding:6px 10px;border:0;border-radius:8px;font-size:12px;cursor:pointer}
.complete{background:var(--accent);color:#fff}
.delete{background:var(--danger);color:#fff}

footer{padding:10px;background:var(--panel);display:flex;justify-content:space-around}
footer button{padding:8px 12px;border-radius:8px;border:0;background:var(--muted);color:var(--text);font-size:13px;cursor:pointer}
</style>
</head>
<body>
<header>
  <div class="logo"></div>
  <div class="title">清单Plus</div>
  <div class="space"></div>
  <button class="iconbtn" id="themeBtn">🌙</button>
</header>

<main>
  <aside class="sidebar">
    <h4>视图</h4>
    <button class="navbtn on" data-filter="all">全部 <span class="counter" id="count-all">0</span></button>
    <button class="navbtn" data-filter="today">今天 <span class="counter" id="count-today">0</span></button>
    <button class="navbtn" data-filter="important">重要 <span class="counter" id="count-important">0</span></button>
    <button class="navbtn" data-filter="done">已完成</button>
    <button class="navbtn" data-filter="undone">未完成</button>
    <h4>分类</h4>
    <button class="navbtn" data-cat="学习">学习</button>
    <button class="navbtn" data-cat="工作">工作</button>
    <button class="navbtn" data-cat="生活">生活</button>
  </aside>

  <section class="content">
    <div class="taskbar">
      <input id="taskInput" type="text" placeholder="输入任务（例如：完成作业/买菜）"/>
      <input id="dateInput" type="date"/>
      <select id="catInput">
        <option value="学习">学习</option>
        <option value="工作">工作</option>
        <option value="生活">生活</option>
      </select>
      <button id="addBtn">添加任务</button>
    </div>

    <div class="filters">
      <div class="filter on" data-repeat="none">不重复</div>
      <div class="filter" data-repeat="daily">每天</div>
      <div class="filter" data-repeat="weekly">每周</div>
      <div class="filter" data-repeat="monthly">每月</div>
      <div class="filter" data-repeat="yearly">每年</div>
    </div>

    <div class="tasks" id="taskList"></div>
  </section>
</main>

<footer>
  <button id="clearDone">清除已完成</button>
  <button id="exportBtn">导出数据</button>
  <button id="importBtn">导入数据</button>
</footer>

<script>
const $=s=>document.querySelector(s);
const $$=s=>document.querySelectorAll(s);
let tasks=JSON.parse(localStorage.getItem("qd.tasks")||"[]");
let filter="all", repeat="none";

function save(){localStorage.setItem("qd.tasks",JSON.stringify(tasks));render();}
function addTask(title,date,cat){
  if(!title) return;
  tasks.push({id:Date.now(),title,date,cat,repeat,done:false,important:false});
  save();
}
function render(){
  const list=$("#taskList");list.innerHTML="";
  let show=tasks.filter(t=>{
    if(filter==="today") return t.date===new Date().toISOString().slice(0,10);
    if(filter==="important") return t.important;
    if(filter==="done") return t.done;
    if(filter==="undone") return !t.done;
    return true;
  });
  show.forEach(t=>{
    const div=document.createElement("div");
    div.className="task"+(t.done?" done":"");
    div.innerHTML=`<div><div class="title">${t.title}</div><div class="sub">${t.date||""} · ${t.cat||""} · ${t.repeat}</div></div>
    <div class="actions">
      <button class="btn-mini complete">${t.done?"撤销":"完成"}</button>
      <button class="btn-mini delete">删除</button>
    </div>`;
    div.querySelector(".complete").onclick=()=>{t.done=!t.done;save();};
    div.querySelector(".delete").onclick=()=>{tasks=tasks.filter(x=>x.id!==t.id);save();};
    list.appendChild(div);
  });
  $("#count-all").textContent=tasks.length;
  $("#count-today").textContent=tasks.filter(t=>t.date===new Date().toISOString().slice(0,10)).length;
  $("#count-important").textContent=tasks.filter(t=>t.important).length;
}
$("#addBtn").onclick=()=>addTask($("#taskInput").value,$("#dateInput").value,$("#catInput").value);
$("#clearDone").onclick=()=>{tasks=tasks.filter(t=>!t.done);save();}
$("#exportBtn").onclick=()=>{
  const blob=new Blob([JSON.stringify(tasks)],{type:"application/json"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");a.href=url;a.download="qingdan.json";a.click();
};
$("#importBtn").onclick=()=>{
  const inp=document.createElement("input");inp.type="file";inp.accept="application/json";
  inp.onchange=e=>{
    const file=e.target.files[0];if(!file)return;
    const fr=new FileReader();fr.onload=()=>{tasks=JSON.parse(fr.result);save();};fr.readAsText(file);
  };
  inp.click();
};
$$(".navbtn").forEach(btn=>btn.onclick=()=>{filter=btn.dataset.filter||"all";$$(".navbtn").forEach(b=>b.classList.remove("on"));btn.classList.add("on");render();});
$$(".filter").forEach(btn=>btn.onclick=()=>{repeat=btn.dataset.repeat;$$(".filter").forEach(b=>b.classList.remove("on"));btn.classList.add("on");});
const themeBtn=$("#themeBtn");themeBtn.onclick=()=>{
  const cur=document.body.getAttribute("data-theme")==="light"?"dark":"light";
  document.body.setAttribute("data-theme",cur);localStorage.setItem("qd.theme",cur);
};
document.body.setAttribute("data-theme",localStorage.getItem("qd.theme")||"dark");
render();
</script>
</body>
</html>

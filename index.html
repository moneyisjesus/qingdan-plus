<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>清单Plus · 我的⼀天</title>
<meta name="theme-color" content="#0f1221" />
<style>
  :root{
    --bg:#0f1221; --panel:#141831; --muted:#a7b0d4; --text:#e9edff;
    --accent:#6d8bff; --accent-2:#9b72ff; --chip:#1a1f3f; --chip-hover:#23294f;
    --ok:#32d27d; --warn:#ffbd2f; --danger:#ff5a6b; --shadow:0 10px 30px rgba(0,0,0,.35); --radius:16px;
  }
  html.light{
    --bg:#f6f8ff; --panel:#ffffff; --muted:#6b7598; --text:#0f1221;
    --accent:#4662ff; --accent-2:#6c4bff; --chip:#eef2ff; --chip-hover:#e4e9ff;
    --shadow:0 10px 30px rgba(22,29,64,.10);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);
    font:16px/1.6 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;}
  .app{max-width:1100px;margin-inline:auto;padding:14px 10px 88px}
  .topbar{display:flex;align-items:center;gap:14px;margin:6px 0 14px}
  .logo{width:44px;height:44px;border-radius:12px;
    background:radial-gradient(120% 120% at 10% 10%, var(--accent), var(--accent-2));
    box-shadow:0 6px 16px rgba(77,99,255,.35)}
  .brand{display:flex;flex-direction:column}
  .brand .name{font-weight:900;letter-spacing:.2px}
  .brand .sub{color:var(--muted);margin-top:-2px}
  .grow{flex:1}
  .now{display:flex;flex-direction:column;align-items:flex-end;gap:2px}
  .now .date{font-weight:800;font-size:16px}
  .now .time{font-weight:900;font-size:22px;letter-spacing:.5px}
  .moon{display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:12px;
    background:var(--panel);color:var(--muted);border:1px solid rgba(255,255,255,.06);box-shadow:var(--shadow);cursor:pointer;font-size:20px}
  .grid{display:grid;grid-template-columns:240px 1fr;gap:16px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .side{background:var(--panel);border-radius:var(--radius);border:1px solid rgba(255,255,255,.06);box-shadow:var(--shadow);padding:14px;position:sticky;top:10px;height:max-content}
  .side h4{margin:6px 6px 10px;color:var(--muted);font-weight:700;font-size:12px}
  .nav{display:flex;flex-direction:column;gap:6px}
  .nav button{all:unset;display:flex;align-items:center;justify-content:space-between;padding:14px;border-radius:12px;cursor:pointer;color:var(--text)}
  .nav button:hover{background:var(--chip-hover)}
  .nav button.active{background:var(--chip);outline:1.5px solid color-mix(in oklab, var(--accent) 60%, transparent)}
  .count{color:var(--muted);font-weight:700;font-size:13px}
  .board{background:var(--panel);border-radius:var(--radius);border:1px solid rgba(255,255,255,.06);box-shadow:var(--shadow);padding:14px}
  .list{display:flex;flex-direction:column;gap:12px}
  .item{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;background:rgba(255,255,255,.02);
    border:1px solid rgba(255,255,255,.06);padding:12px 14px;border-radius:14px}
  .check{width:22px;height:22px;accent-color:var(--accent);cursor:pointer}
  .title input{all:unset;color:var(--text);font-weight:700;font-size:16px}
  .meta{color:var(--muted);font-size:13px;display:flex;gap:10px;align-items:center;margin-top:2px}
  .badge{padding:2px 8px;border-radius:999px;background:var(--chip);border:1px solid rgba(255,255,255,.06)}
  .rating{display:flex;gap:3px}
  .star{width:20px;height:20px;cursor:pointer;background:linear-gradient(90deg,#ffd057,#ffac33);opacity:.35;
    -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2.5 9.7 8H4l4.6 3.4L6.7 17l5.3-3.3 5.3 3.3-1.9-5.6L19.9 8h-5.7L12 2.5z"/></svg>') center/contain no-repeat}
  .star.on{opacity:1}

  /* Composer (bottom) */
  .composer{position:fixed;left:0;right:0;bottom:0;z-index:10;background:linear-gradient(to top,color-mix(in oklab,var(--bg) 100%,transparent),transparent 30%);padding:18px 10px 20px}
  .composer .wrap{max-width:1100px;margin:0 auto;background:var(--panel);border-radius:20px;border:1px solid rgba(255,255,255,.06);box-shadow:var(--shadow);padding:14px}
  .row{display:grid;grid-template-columns:1fr 160px 120px 120px;gap:12px;align-items:center}
  @media (max-width:620px){.row{grid-template-columns:1fr 150px 110px 110px}}
  .field,input[type="date"],input[type="time"],select{
    background:var(--chip);border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:16px 16px;font-size:17px;color:var(--text)}
  .add{all:unset;text-align:center;background:linear-gradient(90deg,var(--accent),var(--accent-2));padding:16px 18px;border-radius:14px;color:#fff;font-weight:800;font-size:17px;cursor:pointer}
</style>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="logo" aria-hidden="true"></div>
      <div class="brand">
        <div class="name">清单Plus</div>
        <div class="sub">记录 · 提醒 · 专注</div>
      </div>
      <div class="grow"></div>
      <!-- live date & time -->
      <div class="now">
        <div class="date" id="nowDate">—</div>
        <div class="time" id="nowTime">—</div>
      </div>
      <button class="moon" id="themeBtn">🌙</button>
    </header>

    <div class="grid">
      <aside class="side">
        <h4>视图</h4>
        <div class="nav" id="filterNav">
          <button data-filter="all" class="active"><span>全部</span><span class="count" id="cAll">0</span></button>
          <button data-filter="today"><span>今天</span><span class="count" id="cToday">0</span></button>
          <button data-filter="important"><span>重要</span><span class="count" id="cImportant">0</span></button>
          <button data-filter="done"><span>已完成</span><span class="count" id="cDone">0</span></button>
          <button data-filter="todo"><span>未完成</span><span class="count" id="cTodo">0</span></button>
        </div>
      </aside>

      <main class="board">
        <div class="list" id="taskList"></div>
        <p id="emptyTip" class="muted" style="text-align:center;margin:30px 0 10px;">没有任务。到底部添加新任务～</p>
      </main>
    </div>
  </div>

  <!-- Composer at bottom -->
  <div class="composer">
    <div class="wrap">
      <div class="row">
        <input id="taskInput" class="field" placeholder="输入任务…" />
        <input id="dateInput" type="date" />
        <input id="timeInput" type="time" />
        <button id="addBtn" class="add">添加</button>
      </div>
    </div>
  </div>

<script>
const $=s=>document.querySelector(s),$$=s=>Array.from(document.querySelectorAll(s));
let tasks=JSON.parse(localStorage.getItem("qingdan-tasks")||"[]"),filter="all";

/* Theme */
$("#themeBtn").onclick=()=>{document.documentElement.classList.toggle("light");
localStorage.setItem("theme",document.documentElement.classList.contains("light")?"light":"dark");
$("#themeBtn").textContent=document.documentElement.classList.contains("light")?"🌞":"🌙";};
if(localStorage.getItem("theme")==="light"){document.documentElement.classList.add("light");$("#themeBtn").textContent="🌞";}

/* Live date & time in header */
function pad(n){return n<10?'0'+n:n}
function fmtDate(d){return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`}
function fmtTime(d){return `${pad(d.getHours())}:${pad(d.getMinutes())}`}
function tickNow(){
  const d=new Date();
  $("#nowDate").textContent=fmtDate(d);
  $("#nowTime").textContent=fmtTime(d);
}
tickNow(); setInterval(tickNow, 1000*15); // update every 15s

/* Helpers */
function save(){localStorage.setItem("qingdan-tasks",JSON.stringify(tasks))}
function todayStr(d=new Date()){return d.toISOString().slice(0,10)}

/* Render */
function render(){
  const list=$("#taskList"); list.innerHTML="";
  const shown=tasks.filter(t=>{
    if(filter==="today")return t.date===todayStr();
    if(filter==="important")return t.star>=4&&!t.done;
    if(filter==="done")return t.done;
    if(filter==="todo")return!t.done;
    return true;
  }).sort((a,b)=>{
    const ad=a.done?1:0,bd=b.done?1:0; if(ad!==bd)return ad-bd;
    const at=a.date||'9999-99-99',bt=b.date||'9999-99-99'; if(at!==bt)return at.localeCompare(bt);
    return (b.star||0)-(a.star||0);
  });

  shown.forEach(t=>{
    const el=document.createElement("div");
    el.className="item"+(t.done?" done":"");
    el.innerHTML=`<input type=checkbox class=check ${t.done?"checked":""}>
      <div class=title>
        <input value="${t.title}" />
        <div class=meta>
          ${t.date?`<span class=badge>📅 ${t.date}</span>`:""}
          ${t.time?`<span class=badge>⏰ ${t.time}</span>`:""}
          ${t.star?`<span class=badge>⭐ ${t.star}</span>`:""}
        </div>
      </div>
      <div class=actions>
        <div class=rating></div>
        <button class=btn-ghost style="color:var(--danger)">删除</button>
      </div>`;
    el.querySelector(".check").onchange=e=>{t.done=e.target.checked;save();render()};
    el.querySelector(".title input").onchange=e=>{t.title=e.target.value;save()};
    el.querySelector(".btn-ghost").onclick=()=>{tasks=tasks.filter(x=>x!==t);save();render()};
    const r=el.querySelector(".rating");
    for(let i=1;i<=5;i++){const s=document.createElement("i");s.className="star"+(i<=t.star?" on":"");
      s.onclick=()=>{t.star=i;save();render()}; r.appendChild(s);}
    list.appendChild(el);
  });

  $("#emptyTip").style.display=shown.length?"none":"block";
  $("#cAll").textContent=tasks.length;
  $("#cToday").textContent=tasks.filter(t=>t.date===todayStr()).length;
  $("#cImportant").textContent=tasks.filter(t=>t.star>=4&&!t.done).length;
  $("#cDone").textContent=tasks.filter(t=>t.done).length;
  $("#cTodo").textContent=tasks.filter(t=>!t.done).length;
}

/* Filters */
$("#filterNav").onclick=e=>{
  const b=e.target.closest("button[data-filter]"); if(!b) return;
  filter=b.dataset.filter; $$("#filterNav button").forEach(x=>x.classList.remove("active")); b.classList.add("active"); render();
}

/* Add */
$("#addBtn").onclick=()=>{
  const title=$("#taskInput").value.trim(); if(!title) return;
  tasks.push({id:Date.now(),title,date:$("#dateInput").value,time:$("#timeInput").value,star:0,done:false});
  save(); $("#taskInput").value=""; render();
}

/* Init */
if(!$("#dateInput").value) $("#dateInput").value=todayStr();
render();
</script>
</body>
</html>
